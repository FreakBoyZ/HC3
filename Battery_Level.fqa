{"name":"Battery Level","type":"com.fibaro.energyMeter","apiVersion":"1.2","initialProperties":{"viewLayout":{"$jason":{"body":{"header":{"style":{"height":"0"},"title":"quickApp_device_728"},"sections":{"items":[{"components":[{"name":"label","style":{"weight":"1.2"},"text":"Label","type":"label","visible":true},{"style":{"weight":"0.5"},"type":"space"}],"style":{"weight":"1.2"},"type":"vertical"}]}},"head":{"title":"quickApp_device_728"}}},"uiCallbacks":[],"quickAppVariables":[],"typeTemplateInitialized":true},"files":[{"name":"main","isMain":true,"isOpen":true,"content":"function level(lv)\n    local a = \"\"\n    if lv == 255 then a = \"游린 0%\"\n    elseif lv > 80 then a = \"游릴游릴游릴游릴 \" .. lv .. \"%\"\n    elseif lv > 60 then a = \"游릳游릳游릳 \" .. lv .. \"%\"\n    elseif lv > 50 then a = \"游릲游릲 \" .. lv .. \"%\"\n    else a = \"游린 \" .. lv .. \"%\" end\n    return a\nend\n\nfunction QuickApp:onInit()\n    devices = fibaro.getDevicesID({interfaces = {\"battery\"}, parentId = 1}) \n    --self:debug(json.encode(devices))\n    local show = \"\"\n    for k,v in ipairs(devices) do\n        local dev = api.get(\"/devices/\".. v+1)\n        if dev.visible == true then\n            show = show .. \"游댊\" .. dev.name .. \" : \" .. level(dev.properties.batteryLevel) .. \"\\n\\n\"\n        end\n    end\n    --self:debug(show)\n    self:updateView(\"label\", \"text\", show)\nend"}]}